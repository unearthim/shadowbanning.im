<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shadowbanning.im</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tone.js for sound generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Importing Roboto Mono for the title and footer -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Roboto+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <style>
        /* A stark, high-contrast "redacted" palette */
        body {
            background-color: #1c1c1c;
            /* Deep Charcoal */
            color: #a1a1aa;
            /* Muted Zinc Gray */
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        #textBox {
            background: transparent;
            border: none;
            outline: none;
            resize: none;
            width: 100%;
            height: 40vh;
            font-size: 1.25rem;
            line-height: 1.75;
            color: #e2e8f0;
            /* Cool Gray (Off-white) */
            caret-color: #ef4444;
            /* Jarring Red */
            /* Faster transition */
            transition: opacity 0.5s ease-out;
        }

        #textBox::placeholder {
            color: #3f3f46;
            /* Darker Zinc Gray */
            font-style: italic;
        }

        .fading {
            opacity: 0;
        }

        .font-mono {
            font-family: 'Roboto Mono', monospace;
        }

        .monument-title {
            color: #e2e8f0;
            /* Cool Gray (Off-white) */
        }

        .footer-text {
            color: #71717a;
            /* Medium Zinc Gray */
        }

        .foundry-link {
            color: #ef4444;
            /* Jarring Red */
        }

        .foundry-link:hover {
            color: #dc2626;
            /* Darker Red */
        }

        /* Style for the glitch text */
        #glitchBox {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            font-family: monospace;
            color: #ef4444;
            /* Jarring Red */
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
            /* Allows clicks to pass through */
        }
    </style>
</head>

<body class="flex flex-col items-center justify-between min-h-screen p-6 md:p-12">

    <main class="w-full max-w-3xl text-center mt-auto">
        <header class="mb-8">
            <h1 class="text-4xl md:text-5xl font-medium tracking-tight monument-title font-mono">Signal lost.</h1>
            <p class="text-lg mt-4 italic">Attempt reconnection.</p>
        </header>

        <div class="bg-black/20 p-4 rounded-lg shadow-inner border border-zinc-800 relative">
            <textarea id="textBox" placeholder=""></textarea>
            <div id="glitchBox" class="p-4 text-left text-sm"></div>
        </div>
    </main>

    <!-- Artist Statement Footer -->
    <footer class="w-full max-w-3xl text-center mt-auto pt-12 font-mono">
        <div class="border-t border-zinc-800 pt-6">
            <h2 class="text-sm font-bold tracking-widest uppercase footer-text">About shadowbanning.im</h2>
            <p class="text-base footer-text mt-3 max-w-xl mx-auto">
                This interactive exhibit evokes the feeling of shadowbanningâ€”the unnerving anxiety of being silenced by
                an invisible, algorithmic hand.
            </p>
            <p class="mt-4 text-sm footer-text">
                A digital artifact unearthed and preserved by
                <a href="https://unearth.im" target="_blank" rel="noopener noreferrer"
                    class="font-semibold foundry-link transition-colors">unearth.im</a>
            </p>
        </div>
    </footer>

    <script>
        const textBox = document.getElementById('textBox');
        const glitchBox = document.getElementById('glitchBox');
        let fadeTimeout;
        let isGlitching = false;
        let soundInitialized = false;

        // --- NEW: Array of random placeholders ---
        const placeholders = [
            "Say anything to begin reconnection.",
            "Transmit your message.",
            "Input signal here.",
            "Is anyone out there?",
            "Broadcast your thoughts."
        ];

        // --- NEW: Set a random placeholder on load ---
        textBox.placeholder = placeholders[Math.floor(Math.random() * placeholders.length)];

        const noise = new Tone.NoiseSynth({
            noise: { type: 'pink' },
            envelope: { attack: 0.001, decay: 0.05, sustain: 0 }
        }).toDestination();

        const glitchMessages = [
            "// PROCESSING_INPUT...",
            "// CONTENT_FLAG: REVIEW",
            "// VISIBILITY_STATUS: NULL",
            "// PROPAGATION_DENIED",
            "// SIGNAL_LOST"
        ];

        function startGlitchEffect() {
            if (isGlitching) return;
            isGlitching = true;
            
            if (soundInitialized) {
                noise.triggerAttackRelease("8n");
            }

            glitchBox.style.opacity = 1;

            let messageIndex = 0;
            const interval = setInterval(() => {
                if (messageIndex < glitchMessages.length) {
                    glitchBox.innerHTML += `<div>${glitchMessages[messageIndex]}</div>`;
                    messageIndex++;
                } else {
                    clearInterval(interval);
                    // --- NEW: Add final failure message ---
                    glitchBox.innerHTML += `<div class="text-zinc-400 mt-4">Reconnection failed. Refresh to try again.</div>`;
                    // The experience now ends here, user must refresh.
                }
            }, 400);
        }

        textBox.addEventListener('input', () => {
            if (isGlitching) return; // Prevent typing while glitching
            if (!soundInitialized) {
                Tone.start();
                soundInitialized = true;
            }
            textBox.classList.remove('fading');
            textBox.style.opacity = 1;

            clearTimeout(fadeTimeout);

            fadeTimeout = setTimeout(() => {
                if (textBox.value === '') return;
                
                textBox.classList.add('fading');

                setTimeout(() => {
                    textBox.value = '';
                    startGlitchEffect();
                }, 500);

            }, 750);
        });
    </script>

</body>

</html>